"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[345],{970:(e,t,s)=>{s.d(t,{Z:()=>C});var n=s(7294),a=s(6010),r=(s(2255),s(6036)),i=s(3446),o=s(4057),c=s(7167),l=s(934);class d{static creds=null;static lastLoggedInUserEmail=null;static lastReadIdTokenIssuedAt=0;static lastReadIdTokenExpiry=0;static _clear=()=>{this.creds=null,this.lastLoggedInUserEmail=null,this.lastReadIdTokenIssuedAt=0,this.lastReadIdTokenExpiry=0};static _isCredsExpired=()=>{if(!this.creds)return!0;if(!this.creds.expiration)return!0;const e=new Date(this.creds.expiration).getTime();if(isNaN(e))return!0;return Date.now()>=e-15e3};static _getIdToken=async()=>{try{const e=new c.AM({UserPoolId:o.Om,ClientId:o.In});if(!e)throw new Error("Error reading from user pool");const t=e.getCurrentUser(),s=await new Promise(((e,s)=>{t.getSession(((t,n)=>{if(t)return s(t.message||JSON.stringify(t));if(!n)return s("No active user session");if(!n.isValid?.())return s("Invalid session");const a=n.getIdToken?.();return a?e(a):s()}))}));if(!s)throw new Error;return s}catch(e){}};static _getJwtIdToken=async()=>{try{const e=await this._getIdToken(),t=e.getJwtToken?.();if(!t)throw new Error;return t}catch(e){}};static _readIdTokenDetails=async()=>{try{const e=await this._getIdToken(),t=e.decodePayload?.();if(!t)throw new Error;return{email:t.email,issuedAt:e.getIssuedAt?.(),exp:e.getExpiration?.()}}catch(e){}};static _isUserSessionChangedOrExpired=async()=>{try{const{email:t,issuedAt:s,exp:n}=await this._readIdTokenDetails();var e=!1;return this.lastLoggedInUserEmail==t&&this.lastReadIdTokenIssuedAt==s&&this.lastReadIdTokenExpiry==n||(e=!0),this.lastLoggedInUserEmail=t,this.lastReadIdTokenIssuedAt=s,this.lastReadIdTokenExpiry=n,e?(this.creds=null,!0):n<=Math.floor(Date.now()/1e3)-10}catch(t){throw new Error(t)}};static _fetchCredsForLoggedInUser=async e=>{try{const e=await this._getJwtIdToken(),t=(0,l.s)({identityPoolId:o.vX,clientConfig:{region:o.U3},logins:{[`cognito-idp.${o.U3}.amazonaws.com/${o.Om}`]:e}});if(!t)throw new Error("Error getting fn that fetches credentials");const s=await t();return this.creds=s,s}catch(t){throw new Error("Error fetching credentials for logged-in user")}};static isExpired=async()=>!!await this._isUserSessionChangedOrExpired()||!!this._isCredsExpired();static getCredsForLoggedInUser=async()=>{try{if(await this.isExpired()){return{creds:await this._fetchCredsForLoggedInUser(),isFromCache:!1}}return{creds:this.creds,isFromCache:!0}}catch(e){throw new Error("Error getting credentials for logged-in user")}}}class m{static ddbClient=null;static ddbDocClient=null;static close=()=>{this.ddbDocClient&&(this.ddbDocClient.destroy(),this.ddbDocClient=null),this.ddbClient&&(this.ddbClient.destroy(),this.ddbClient=null)};static _initIfNotAlready=async()=>{try{const{creds:e,isFromCache:t}=await d.getCredsForLoggedInUser();return t?(this.ddbClient&&"DynamoDBClient"===this.ddbClient.constructor.name&&this.ddbDocClient||(this.close(),this.ddbClient=new r.c({region:o.U3,credentials:e}),this.ddbDocClient=i.m1.from(this.ddbClient)),this.ddbDocClient):(this.close(),this.ddbClient=new r.c({region:o.U3,credentials:e}),this.ddbDocClient=i.m1.from(this.ddbClient),this.ddbDocClient)}catch(e){console.log("getDynamoDbDocClient():",e.message||e.code||e.name||"Error initiating DB client")}};static queryData=async e=>{try{if(!e)throw new Error("No query specified");await this._initIfNotAlready();return await this.ddbDocClient.send(new i.cI(e))}catch(t){console.log("queryData():",t.message||t.code||t.name||"Error querying data from database")}};static getItemData=async e=>{try{if(!e)throw new Error("No query specified");await this._initIfNotAlready();return await this.ddbDocClient.send(new i.Bj(e))}catch(t){console.log("getItemData():",t.message||t.code||t.name||"Error fetching data from database")}}}var h=s(9316);const u="investments_PghJ",g="id_LKDL",y="start_xEGx",p="end_NChH",E="roi_DSlC",f="sts_pMX4",I="active_utcN",w="closed_tKl3",D="amt_XPn2";class b{static months=["January","February","March","April","May","June","July","August","September","October","November","December"];static monthsAbr=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];static getLetterFormatedDate=(e,t)=>{if(!e)return"";if(!Number.isInteger(e))return"";"boolean"!=typeof t&&(t=!1);const s=new Date(1e3*e);return t?s.getDate()+" "+this.monthsAbr[s.getMonth()]+" "+s.getFullYear():s.getDate()+" "+this.months[s.getMonth()]+" "+s.getFullYear()};static getNumberFormatedDate=(e,t,s)=>{if(!e)return"";if(!Number.isInteger(e))return"";t&&"string"==typeof t||(t="-"),"boolean"!=typeof s&&(s=!1);const n=new Date(1e3*e);let a=n.getDate(),r=n.getMonth()+1;return s&&(a=a<10?"0"+a:a,r=r<10?"0"+r:r),a+t+r+t+n.getFullYear()};static getDayOrdinal=e=>{const t=e.toString(),s=t.slice(-1);return"1"===s&&"11"!==t?`${t}st`:"2"===s&&"12"!==t?`${t}nd`:"3"===s&&"13"!==t?`${t}rd`:`${t}th`}}class C extends n.Component{constructor(e){super(e),this.state={isWip:!0,investments:{}}}fetchDataFromDb=async()=>{try{let e={TableName:"LunaticCapital_Users",Key:{ID:this.props.cognitoUser.id},ProjectionExpression:"Invst"};const t=await m.getItemData(e);if(console.log("dynamoDbResponse:",t),!t||t=={}||null==t.Item)throw new Error("No investments on record");return this.setState({investments:t.Item.Invst}),t.Item.Invst}catch(e){this.props.notify(e.message||e.name||e.code||"Error fetching investments","err")}};componentDidMount(){this.fetchDataFromDb().finally((()=>{this.setState({isWip:!1})}))}render(){return Object.keys(this.state.investments).length>0?n.createElement("div",null,n.createElement("ul",{className:(0,a.Z)(u,"clean-list")},n.createElement("li",{key:"header"},n.createElement("span",{className:y},"Start Date"),n.createElement("span",{className:p},"End Date"),n.createElement("span",{className:g},"ID"),n.createElement("span",{className:f},"Status"),n.createElement("span",{className:D},"Capital Amt"),n.createElement("span",{className:E},"ROI")),Object.keys(this.state.investments).map(((e,t)=>{const s=Number(this.state.investments[e].end)<Math.floor((new Date).getTime()/1e3);return n.createElement("li",{key:e,className:s?w:I},n.createElement("span",{className:y},b.getLetterFormatedDate(Number(e),!0)),n.createElement("span",{className:p},b.getLetterFormatedDate(Number(this.state.investments[e].end),!0)),n.createElement("span",{className:g},e),n.createElement("span",{className:f},s?"Closed":"Active"),n.createElement("span",{className:D},this.state.investments[e].amt),n.createElement("span",{className:E},this.state.investments[e].prcntROI+"% every "+this.state.investments[e].payoutDaysCyc+" days"))}))),this.state.isWip&&0==Object.keys(this.state.investments).length&&n.createElement(h.Z,{note:"Loading"})):this.state.isWip?n.createElement("div",null,"Loading..."):n.createElement("div",null,"No records")}}},5574:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});var n=s(7294),a=s(6550),r=s(2263),i=s(9230),o=s(6787),c=s(1705),l=s(1262);function d(){const{siteConfig:e}=(0,r.Z)(),t=n.useContext(o._1),{notify:d}=n.useContext(c.z);return t.isLoggedIn?n.createElement(i.Z,{title:`Investments at ${e.title}`,description:"My investments at Lunatic Capital"},n.createElement("main",{className:"container margin-vert--lg"},n.createElement("h1",null,"My Investments"),n.createElement(l.Z,null,(()=>{const e=s(970).Z;return n.createElement(e,{cognitoUser:t,notify:d})})))):n.createElement(a.l_,{to:`${e.baseUrl}login`})}}}]);