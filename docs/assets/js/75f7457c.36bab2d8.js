"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[345],{970:(t,e,s)=>{s.d(e,{Z:()=>v});var a=s(7294),r=s(6010),n=s(2255),i=s(6036),o=s(2557),l=s(4057),c=s(7167),d=s(934);class h{static creds=null;static lastLoggedInUserEmail=null;static lastReadIdTokenIssuedAt=0;static lastReadIdTokenExpiry=0;static _clear=()=>{this.creds=null,this.lastLoggedInUserEmail=null,this.lastReadIdTokenIssuedAt=0,this.lastReadIdTokenExpiry=0};static _isCredsExpired=()=>{if(!this.creds)return!0;if(!this.creds.expiration)return!0;const t=new Date(this.creds.expiration).getTime();if(isNaN(t))return!0;return Date.now()>=t-15e3};static _getIdToken=async()=>{try{const t=new c.AM({UserPoolId:l.Om,ClientId:l.In});if(!t)throw new Error("Error reading from user pool");const e=t.getCurrentUser(),s=await new Promise(((t,s)=>{e.getSession(((e,a)=>{if(e)return s(e.message||JSON.stringify(e));if(!a)return s("No active user session");if(!a.isValid?.())return s("Invalid session");const r=a.getIdToken?.();return r?t(r):s()}))}));if(!s)throw new Error;return s}catch(t){}};static _getJwtIdToken=async()=>{try{const t=await this._getIdToken(),e=t.getJwtToken?.();if(!e)throw new Error;return e}catch(t){}};static _readIdTokenDetails=async()=>{try{const t=await this._getIdToken(),e=t.decodePayload?.();if(!e)throw new Error;return{email:e.email,issuedAt:t.getIssuedAt?.(),exp:t.getExpiration?.()}}catch(t){}};static _isUserSessionChangedOrExpired=async()=>{try{const{email:e,issuedAt:s,exp:a}=await this._readIdTokenDetails();var t=!1;return this.lastLoggedInUserEmail==e&&this.lastReadIdTokenIssuedAt==s&&this.lastReadIdTokenExpiry==a||(t=!0),this.lastLoggedInUserEmail=e,this.lastReadIdTokenIssuedAt=s,this.lastReadIdTokenExpiry=a,t?(this.creds=null,!0):a<=Math.floor(Date.now()/1e3)-10}catch(e){throw new Error(e)}};static _fetchCredsForLoggedInUser=async t=>{try{const t=await this._getJwtIdToken(),e=(0,d.s)({identityPoolId:l.vX,clientConfig:{region:l.U3},logins:{[`cognito-idp.${l.U3}.amazonaws.com/${l.Om}`]:t}});if(!e)throw new Error("Error getting fn that fetches credentials");const s=await e();return this.creds=s,s}catch(e){throw new Error("Error fetching credentials for logged-in user")}};static isExpired=async()=>!!await this._isUserSessionChangedOrExpired()||!!this._isCredsExpired();static getCredsForLoggedInUser=async()=>{try{if(await this.isExpired()){return{creds:await this._fetchCredsForLoggedInUser(),isFromCache:!1}}return{creds:this.creds,isFromCache:!0}}catch(t){throw new Error("Error getting credentials for logged-in user")}}}class m{static ddbClient=null;static ddbDocClient=null;static close=()=>{this.ddbDocClient&&(this.ddbDocClient.destroy(),this.ddbDocClient=null),this.ddbClient&&(this.ddbClient.destroy(),this.ddbClient=null)};static _initIfNotAlready=async()=>{try{const{creds:t,isFromCache:e}=await h.getCredsForLoggedInUser();return e?(this.ddbClient&&"DynamoDBClient"===this.ddbClient.constructor.name&&this.ddbDocClient||(this.close(),this.ddbClient=new i.c({region:l.U3,credentials:t}),this.ddbDocClient=o.m1.from(this.ddbClient)),this.ddbDocClient):(this.close(),this.ddbClient=new i.c({region:l.U3,credentials:t}),this.ddbDocClient=o.m1.from(this.ddbClient),this.ddbDocClient)}catch(t){console.log("getDynamoDbDocClient():",t.message||t.code||t.name||"Error initiating DB client")}};static queryData=async t=>{try{if(!t)throw new Error("No query specified");await this._initIfNotAlready();return await this.ddbDocClient.send(new o.cI(t))}catch(e){console.log("queryData():",e.message||e.code||e.name||"Error querying data from database")}}}var u=s(9316);const g="investments_PghJ",y="id_LKDL",E="start_xEGx",p="end_NChH",f="roi_DSlC",D="sts_pMX4",C="active_utcN",w="closed_tKl3",I="amt_XPn2";class b{static months=["January","February","March","April","May","June","July","August","September","October","November","December"];static monthsAbr=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];static getLetterFormatedDate=(t,e)=>{if(!t)return"";if(!Number.isInteger(t))return"";"boolean"!=typeof e&&(e=!1);const s=new Date(1e3*t);return e?s.getDate()+" "+this.monthsAbr[s.getMonth()]+" "+s.getFullYear():s.getDate()+" "+this.months[s.getMonth()]+" "+s.getFullYear()};static getNumberFormatedDate=(t,e,s)=>{if(!t)return"";if(!Number.isInteger(t))return"";e&&"string"==typeof e||(e="-"),"boolean"!=typeof s&&(s=!1);const a=new Date(1e3*t);let r=a.getDate(),n=a.getMonth()+1;return s&&(r=r<10?"0"+r:r,n=n<10?"0"+n:n),r+e+n+e+a.getFullYear()};static getDayOrdinal=t=>{const e=t.toString(),s=e.slice(-1);return"1"===s&&"11"!==e?`${e}st`:"2"===s&&"12"!==e?`${e}nd`:"3"===s&&"13"!==e?`${e}rd`:`${e}th`}}class v extends a.Component{constructor(t){super(t),this.state={isWip:!0,isLoadMoreWip:!1,dataAry:[],lastEvalKey:null}}fetchDataFromDb=async()=>{let t={};try{let e={TableName:"LunaticCapital_Investments",KeyConditionExpression:"#User = :u",ExpressionAttributeNames:{"#User":"User"},ExpressionAttributeValues:{":u":this.props.cognitoUser.id},ScanIndexForward:!1,Limit:10};if(this.state.lastEvalKey&&(e.ExclusiveStartKey=this.state.lastEvalKey),t=await m.queryData(e),t.Count<1)return this.props.notify(this.state.lastEvalKey?"No more older investment records":"No investment on record"),this.setState({lastEvalKey:null}),null;null!=this.state.lastEvalKey?this.setState((e=>({dataAry:[...e.dataAry,...t.Items]}))):this.setState({dataAry:t.Items}),t.LastEvaluatedKey?this.setState({lastEvalKey:t.LastEvaluatedKey}):this.setState({lastEvalKey:null})}catch(e){console.log("fetchDataFromDb():",e.message||e.name||e.code||"Error fetching transactions"),this.props.notify(e.message||e.name||e.code||"Error fetching transactions","err")}};doLoadMore=()=>{this.setState({isLoadMoreWip:!0}),this.fetchDataFromDb().finally((()=>{this.setState({isLoadMoreWip:!1})}))};componentDidMount(){this.fetchDataFromDb().finally((()=>{this.setState({isWip:!1})}))}render(){return this.state.dataAry.length>0?a.createElement("div",null,a.createElement("ul",{className:(0,r.Z)(g,"clean-list")},a.createElement("li",{key:"header"},a.createElement("span",{className:E},"Start Date"),a.createElement("span",{className:p},"End Date"),a.createElement("span",{className:y},"ID"),a.createElement("span",{className:D},"Status"),a.createElement("span",{className:I},"Capital Amt"),a.createElement("span",{className:f},"ROI")),this.state.dataAry.map(((t,e)=>{let s="";return Object.prototype.hasOwnProperty.call(t,"End")&&!isNaN(t?.End)&&(s=b.getLetterFormatedDate(t.End,!0)),a.createElement("li",{key:t.Date,className:""==s.trim()?C:w},a.createElement("span",{className:E},b.getLetterFormatedDate(t.Date,!0)),a.createElement("span",{className:p},""==s.trim()?"-":s),a.createElement("span",{className:y},t.Date),a.createElement("span",{className:D},""==s.trim()?"Active":"Closed"),a.createElement("span",{className:I},t.Amt),a.createElement("span",{className:f},t.ROIpercent+"% every "+t.ROIdaysCycle+" days"))}))),this.state.lastEvalKey&&a.createElement(n.pi,null,a.createElement(n.ZP,{variant:"secondary",size:"small",onClick:this.doLoadMore,isWip:this.state.isWip,wipText:"Loading"},"List older investments")),this.state.isWip&&0==this.state.dataAry.length&&a.createElement(u.Z,{note:"Loading"})):this.state.isWip?a.createElement("div",null,"Loading..."):a.createElement("div",null,"No records")}}},5574:(t,e,s)=>{s.r(e),s.d(e,{default:()=>d});var a=s(7294),r=s(6550),n=s(2263),i=s(9230),o=s(6787),l=s(1705),c=s(1262);function d(){const{siteConfig:t}=(0,n.Z)(),e=a.useContext(o._1),{notify:d}=a.useContext(l.z);return e.isLoggedIn?a.createElement(i.Z,{title:`Investments at ${t.title}`,description:"My investments at Lunatic Capital"},a.createElement("main",{className:"container margin-vert--lg"},a.createElement("h1",null,"My Investments"),a.createElement(c.Z,null,(()=>{const t=s(970).Z;return a.createElement(t,{cognitoUser:e,notify:d})})))):a.createElement(r.l_,{to:`${t.baseUrl}login`})}}}]);